



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Query Format - Zoltar Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#querying-a-projects-forecasts" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Zoltar Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Zoltar Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Query Format
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Zoltar Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Zoltar Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Web Tour
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Web Tour
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../WebTourIntro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HomePage/" title="Zoltar Home page" class="md-nav__link">
      Zoltar Home page
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ProjectDetailPage/" title="Project detail page" class="md-nav__link">
      Project detail page
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ModelDetailPage/" title="Model detail page" class="md-nav__link">
      Model detail page
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ForecastDetailPage/" title="Forecast detail page" class="md-nav__link">
      Forecast detail page
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../UserIntro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Projects/" title="Projects" class="md-nav__link">
      Projects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Forecasts/" title="Forecasts" class="md-nav__link">
      Forecasts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scoring/" title="Scores" class="md-nav__link">
      Scores
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Visualization/" title="Visualiations" class="md-nav__link">
      Visualiations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Truth/" title="Truth" class="md-nav__link">
      Truth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Accounts/" title="Accounts" class="md-nav__link">
      Accounts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DataModel/" title="Data model" class="md-nav__link">
      Data model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FileFormats/" title="File Formats" class="md-nav__link">
      File Formats
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Query Format
      </label>
    
    <a href="./" title="Query Format" class="md-nav__link md-nav__link--active">
      Query Format
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#querying-workflow" class="md-nav__link">
    Querying workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-format" class="md-nav__link">
    Query format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-format" class="md-nav__link">
    Data format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-limits" class="md-nav__link">
    Data limits
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Targets/" title="Targets" class="md-nav__link">
      Targets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Validation/" title="Validation" class="md-nav__link">
      Validation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Programming libraries and API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Programming libraries and API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ApiIntro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Zoltpy/" title="zoltpy (Python)" class="md-nav__link">
      zoltpy (Python)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Zoltr/" title="zoltr (R)" class="md-nav__link">
      zoltr (R)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Api/" title="RESTful API" class="md-nav__link">
      RESTful API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#querying-workflow" class="md-nav__link">
    Querying workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-format" class="md-nav__link">
    Query format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-format" class="md-nav__link">
    Data format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-limits" class="md-nav__link">
    Data limits
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="querying-a-projects-forecasts">Querying a project's forecasts<a class="headerlink" href="#querying-a-projects-forecasts" title="Permanent link">&para;</a></h1>
<p>In addition to the ability to download individual forecasts via both the <a href="../Forecasts/#download-a-single-forecast">Web UI</a> and the <a href="../ApiIntro/">Zoltar libraries</a>, Zoltar supports downloading multiple forecasts at once, but currently only through the libraries.</p>
<h2 id="querying-workflow">Querying workflow<a class="headerlink" href="#querying-workflow" title="Permanent link">&para;</a></h2>
<p>Like <a href="../Forecasts/#upload-a-forecast">uploading a forecast</a>, querying a project's forecasts can be a long operation. For this reason, Zoltar <em>enqueues</em> queries as jobs that are operated on separately from the web process. This means querying follows these steps:</p>
<ol>
<li>Create and submit the <a href="#query_format">query</a>. This returns a job that you can use to a) track the status of the query, and b) download the query results (forecast data).</li>
<li>Poll the job until its status is <strong>SUCCESS</strong>. (You can use the Web UI to do this as well. See <a href="../Forecasts/#check_an_uploads_status">Check an upload's status</a> for how.)</li>
<li>Download the data associated with the job.</li>
</ol>
<h2 id="query-format">Query format<a class="headerlink" href="#query-format" title="Permanent link">&para;</a></h2>
<p>Zoltar supports a simple filtering feature that allows users to limit what data is downloaded.</p>
<p>To filter a project's forecast data, we will support the following five types of filters. They are passed behind the scenes to the server as JSON.</p>
<blockquote>
<p>Note that <em>server IDs</em> are passed, not URLs or names, which makes queries unambiguous. Libraries will provide helper functions that hide details and make the feature more convenient. For example, instead of passing time zeros as IDs, the user will be able to use our standard <code>yyyy-mm-dd</code> format, which the library will convert to IDs.</p>
</blockquote>
<p>Logically, the filters are treated as a list of "ANDs of ORs": Each of the five filter types are lists that are considered individually as ORs. For example, a list of model IDs means get data from <em>any</em> of them. The filters are combined by ANDs, meaning only data that matches <em>all</em> filters. For example</p>
<p>The types of filters:</p>
<p>1) Filter by <em>model</em>: Pass zero or more model IDs in the <code>models</code> field. Example:</p>
<pre><code class="json">{&quot;models&quot;: [150, 237]}  # gets data only from either of these two models. 150 = &quot;60-contact&quot;, 237 = &quot;CovidIL_100&quot;
</code></pre>

<p>2) Filter by <em>unit</em>: Pass zero or more unit IDs <code>units</code> field. Example:</p>
<pre><code class="json">{&quot;units&quot;: [335]}  # get data only for these this unit. 335 = &quot;US&quot;
</code></pre>

<p>3) Filter by <em>target</em>: Pass zero or more target IDs in the <code>targets</code> field. Example:</p>
<pre><code class="json">{&quot;targets&quot;: [1894, 1897]}  # get data only for either of these two targets. 1894 = &quot;0 day ahead cum death&quot;, 1897 = &quot;1 day ahead cum death&quot;
</code></pre>

<p>4) Filter by <em>timezero</em>: Pass zero or more timezero IDs in the <code>timezeros</code> field. Example:</p>
<pre><code class="json">{&quot;timezeros&quot;: [739, 738]}  # get data only for either of these two time zeros. 739 = &quot;2020-05-14&quot;, 738 = &quot;2020-05-09&quot;
</code></pre>

<p>5) Filter by forecast <em>type</em>: Pass a list of string types in the <code>types</code> field. Choices are <code>bin</code>, <code>named</code>, <code>point</code>, <code>sample</code>, and <code>quantile</code>. Treated as "OR". Example:</p>
<pre><code class="json">{&quot;types&quot;: [&quot;point&quot;, &quot;quantile&quot;]}  # get only point and quantile data
</code></pre>

<p>The lists in 1, 2, 3, and 4 operate as "OR" on their own, but they are combined as "AND"s. Here's an example:</p>
<pre><code class="json">{&quot;models&quot;: [150, 237],
 &quot;units&quot;: [335],
 &quot;targets&quot;: [1894, 1897],
 &quot;timezeros&quot;: [739, 738],
 &quot;types&quot;: [&quot;point&quot;, &quot;quantile&quot;]
}
</code></pre>

<p>This results in data that is:</p>
<ul>
<li>(from either the <code>60-contact</code> OR <code>CovidIL_100</code> models) AND</li>
<li>(the unit is <code>US</code>) AND</li>
<li>(the target is either <code>0 day ahead cum death</code> or <code>1 day ahead cum death</code>) AND</li>
<li>(the timezero is either <code>2020-05-14</code> OR <code>2020-05-09</code>) AND</li>
<li>(the prediction type is either <code>point</code> OR <code>quantile</code>)</li>
</ul>
<p>Note that not all types of filters are required to be specified. Any missing ones are treated by default as "all". In the previous example, if we omitted <code>types</code> then we'd get similar data except it would include all prediction types instead of just <code>point</code> or <code>quantile</code> ones.</p>
<h2 id="data-format">Data format<a class="headerlink" href="#data-format" title="Permanent link">&para;</a></h2>
<p>Data is returned in tabular CVS format with the following columns. Because we support five different prediction types in our <a href="../DataModel/">Data Model</a>, the format of each row must account for all possible values. For this reason, the CSV is 'sparse': not every row uses all columns; unused ones are empty (''). Note that the first six columns are always present for any prediction type.</p>
<ul>
<li><code>model</code>: the model's abbreviation (if defined) or name </li>
<li><code>timezero</code>: date the truth applies to, formatted as <code>yyyy-mm-dd</code></li>
<li><code>season</code>: the season the <code>timezero</code> corresponds to. empty if no defined seasons in the project</li>
<li><code>unit</code>: the unit's name</li>
<li><code>target</code>: target name</li>
<li><code>class</code>: prediction type. one of <code>bin</code>, <code>named</code>, <code>point</code>, <code>sample</code>, and <code>quantile</code></li>
<li><code>value</code>: used for <code>point</code> and <code>quantile</code> prediction types. empty otherwise</li>
<li><code>cat</code>: used for <code>bin</code> prediction types. empty otherwise</li>
<li><code>prob</code>: ""</li>
<li><code>sample</code>: used for <code>sample</code> prediction types. empty otherwise</li>
<li><code>quantile</code>: used for <code>quantile</code> prediction types. empty otherwise</li>
<li><code>family</code>: used for <code>named</code> prediction types. empty otherwise</li>
<li><code>param1</code>: ""</li>
<li><code>param2</code>: ""</li>
<li><code>param3</code>: ""</li>
</ul>
<h2 id="data-limits">Data limits<a class="headerlink" href="#data-limits" title="Permanent link">&para;</a></h2>
<p>Because queries have the potential to return millions of rows, we currently limit the number of them to 100,000. If a query would return more than that, then the query fails.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../FileFormats/" title="File Formats" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                File Formats
              </span>
            </div>
          </a>
        
        
          <a href="../Targets/" title="Targets" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Targets
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>